---
title: "Site frequency spectrum"
author: "Kevin Thornton"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Site frequency spectrum}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

~~~{r}
library(diseaseSims)
library(dplyr)
##n = 100, and if you use n >= 2N, 2N will be used
##seed = 101
sfs.all = sfs("pop.bin.gz",100,101)

##Normalize the SFS
sfs.norm = sfs.all %>%
    group_by(replicate) %>%
        mutate( n.norm = n/sum(n),
                r.norm = r/sum(r) )

##Average, normalized SFS
sfs.norm.mean = sfs.norm %>%
    group_by(i) %>%
        summarise(n.norm.mean = mean(n.norm),
                  r.norm.mean = mean(r.norm))

plot(sfs.norm.mean$i,sfs.norm.mean$n.norm.mean,xlab=("Frequency (out of 100)"),ylab="Proportion of mutations",ylim=c(0,1))
points(sfs.norm.mean$i,sfs.norm.mean$r.norm.mean,pch=18,col="red")
~~~
